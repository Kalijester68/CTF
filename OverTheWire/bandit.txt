Over The Wire - Bandit

Host:   bandit.labs.overthewire.org
Port:   2220

===
Level 0

Objective:

The password for the next level is stored in a file called "readme" located in the home directory.  Use this password to log into bandit1 using SSH. Whenever you find a password for a level, use SSH (on port 2220) to log into that level and continue the game.

  $ ssh [user@]hostname -p [:port]
  $ ssh bandit0@bandit.labs.overthewire.org -p 2220
  password: bandit0

CLI:

  bandit0@bandit:~$ ls
  readme
  bandit0@bandit:~$ cat readme
  NH2SXQwcBdpmTEzi3bvBHMM9H66vVXjL

---
Level 1

$ ssh bandit1@bandit.labs.overthewire.org -p 2220
password: NH2SXQwcBdpmTEzi3bvBHMM9H66vVXjL

Objective:

The password for the next level is stored in a file called "-" located in the home directory.

  Use flow redirection to read the file.

CLI:

  bandit1@bandit:~$ ls
  -
  bandit1@bandit:~$ cat < -
  rRGizSaX8Mk1RTb1CNQoXTcYZWU6lgzi

---
Level 2

ssh bandit2@bandit.labs.overthewire.org -p 2220
password: rRGizSaX8Mk1RTb1CNQoXTcYZWU6lgzi

Objective:

The password for the next level is stored in a file called spaces in this filename located in the home directory.

  Use cat "[filename with spaces]"

CLI:

  bandit2@bandit:~$ ls
  spaces in this filename
  bandit2@bandit:~$ cat "spaces in this filename"
  aBZ0W5EmUfAf7kHTQeOwd8bauFJ2lAiG

---
Level 3

ssh bandit3@bandit.labs.overthewire.org -p 2220
password: aBZ0W5EmUfAf7kHTQeOwd8bauFJ2lAiG

Objective:

The password for the next level is stored in a hidden file in the inhere directory.

  cd into directory
  ls -a to show all files including hidden
  cat .hidden

CLI:

  bandit3@bandit:~$ ls
  inhere
  bandit3@bandit:~$ cd inhere
  bandit3@bandit:~/inhere$ ls
  bandit3@bandit:~/inhere$ ls -a
  .  ..  .hidden
  bandit3@bandit:~/inhere$ cat .hidden
  2EW7BBsr6aMMoJ2HjW067dm8EgX26xNe
  bandit3@bandit:~/inhere$ 

---
Level 4

ssh bandit4@bandit.labs.overthewire.org -p 2220
password: 2EW7BBsr6aMMoJ2HjW067dm8EgX26xNe

Objective:

The password for the next level is stored in the only human-readable file in the inhere directory. Tip: if your terminal is messed up, try the “reset” command.

  ls
  file ./-file*
  cat "./-file07"  

CLI:

  bandit4@bandit:~$ ls
  inhere
  bandit4@bandit:~$ cd inhere
  bandit4@bandit:~/inhere$ ls
  -file00  -file02  -file04  -file06  -file08
  -file01  -file03  -file05  -file07  -file09
  bandit4@bandit:~/inhere$ file ./-file*
  ./-file00: data
  ./-file01: data
  ./-file02: data
  ./-file03: data
  ./-file04: data
  ./-file05: data
  ./-file06: data
  ./-file07: ASCII text
  ./-file08: data
  ./-file09: data
  bandit4@bandit:~/inhere$ cat "./-file07"
  lrIWWI6bB37kxfiCQZqUdOIYfr6eEeqR
  bandit4@bandit:~/inhere$ 

---
Level 5

ssh bandit5@bandit.labs.overthewire.org -p 2220
password: lrIWWI6bB37kxfiCQZqUdOIYfr6eEeqR

Objective:

The password for the next level is stored in a file somewhere under the "inhere" directory and has all of the following properties:

    human-readable
    1033 bytes in size
    not executable

  $ find -readable -size 1033c ! -executable

  The find command with some flags
    -readable is human-readable
    -size 1033c means in bytes
    ! -executable means not executable

CLI:
  
  bandit5@bandit:~$ ls
  inhere
  bandit5@bandit:~$ cd inhere
  bandit5@bandit:~/inhere$ ls
  maybehere00  maybehere04  maybehere08  maybehere12  maybehere16
  maybehere01  maybehere05  maybehere09  maybehere13  maybehere17
  maybehere02  maybehere06  maybehere10  maybehere14  maybehere18
  maybehere03  maybehere07  maybehere11  maybehere15  maybehere19
  bandit5@bandit:~/inhere$ find -readable -size 1033c ! -executable
  ./maybehere07/.file2
  bandit5@bandit:~/inhere$ cat ./maybehere07/.file2
  P4L4vucdmLnm8I7Vl7jG1ApGSfjYKqJU
  bandit5@bandit:~/inhere$

---
Level 6

ssh bandit6@bandit.labs.overthewire.org -p 2220
password: P4L4vucdmLnm8I7Vl7jG1ApGSfjYKqJU

Objective:

The password for the next level is stored somewhere on the server and has all of the following properties:

    owned by user bandit7
    owned by group bandit6
    33 bytes in size

  $ find / -user bandit7 -group bandit6 -size 33c 2>/dev/null

    2>/dev/null will remove the errors because we are not in root for a "clean" result

CLI:

bandit6@bandit:~$ find / -user bandit7 -group bandit6 -size 33c 2>/dev/null
/var/lib/dpkg/info/bandit7.password
bandit6@bandit:~$ cat /var/lib/dpkg/info/bandit7.password
z7WtoNQU2XfjmMtWA8u5rN4vzqu4v99S
bandit6@bandit:~

---
Level 7

ssh bandit7@bandit.labs.overthewire.org -p 2220
password: z7WtoNQU2XfjmMtWA8u5rN4vzqu4v99S

Objective:

The password for the next level is stored in the file data.txt next to the word millionth.

  $cat data.txt | grep millionth

    With the pipe "|" we can use cat and grep to look through the text file because they are on the same line.

CLI:

  bandit7@bandit:~$ du -b data.txt
  4184396	data.txt
  bandit7@bandit:~$ cat data.txt | grep millionth
  millionth	TESKZC0XvTetK0S9xNwm25STk5iWrBvP
  bandit7@bandit:~$

---
Level 8

ssh bandit8@bandit.labs.overthewire.org -p 2220
password: TESKZC0XvTetK0S9xNwm25STk5iWrBvP

Objective:

The password for the next level is stored in the file data.txt and is the only line of text that occurs only once.

$ sort data.txt | uniq -u

CLI:

bandit8@bandit:~$ ls
data.txt
bandit8@bandit:~$ sort data.txt | uniq -u
EN632PlfYiZbn3PhVK3XOGSlNInNE00t

---
Level 9

ssh bandit9@bandit.labs.overthewire.org -p 2220
password: EN632PlfYiZbn3PhVK3XOGSlNInNE00t

Objective:

The password for the next level is stored in the file data.txt in one of the few human-readable strings, preceded by several ‘=’ characters.

CLI:

bandit9@bandit:~$ strings data.txt | grep ===
x]T========== theG)"
========== passwordk^
========== is
========== G7w8LIi6J3kTb8A7j9LgrywtEUlyyp6s
bandit9@bandit:~$

---
Level 10

ssh bandit10@bandit.labs.overthewire.org -p 2220
password: G7w8LIi6J3kTb8A7j9LgrywtEUlyyp6s

Objective:

The password for the next level is stored in the file data.txt, which contains base64 encoded data.

$ base64 -d data.txt

CLI:

bandit10@bandit:~$ base64 -d data.txt
The password is 6zPeziLdR2RKNdNYFNb6nVCKzphlXHBM
bandit10@bandit:~$

---
Level 11

ssh bandit11@bandit.labs.overthewire.org -p 2220
password: 6zPeziLdR2RKNdNYFNb6nVCKzphlXHBM

Objective:

The password for the next level is stored in the file data.txt, where all lowercase (a-z) and uppercase (A-Z) letters have been rotated by 13 positions.

$ cat data.txt | tr 'A-Za-z' 'N-ZA-Mn-za-m'

tr <old_chars> <new_chars> is the translate command
ROT13 cipher: 'A-Za-z' 'N-ZA-Mn-za-m'
ROT5 cipher: '5-90-4'

CLI:

bandit11@bandit:~$ cat data.txt | tr 'A-Za-z' 'N-ZA-Mn-za-m'
The password is JVNBBFSmZwKKOP0XbFXOoW8chDz5yVRv
bandit11@bandit:~$

---
Level 12

ssh bandit12@bandit.labs.overthewire.org -p 2220
password: JVNBBFSmZwKKOP0XbFXOoW8chDz5yVRv

Objective:

The password for the next level is stored in the file data.txt, which is a hexdump of a file that has been repeatedly compressed. For this level it may be useful to create a directory under /tmp in which you can work using mkdir. For example: mkdir /tmp/myname123. Then copy the datafile using cp, and rename it using mv (read the manpages!)

CLI:

bandit12@bandit:~$ mktemp -d
/tmp/tmp.tXJKa7KVxR
bandit12@bandit:~$ cd /tmp/tmp.tXJKa7KVxR
bandit12@bandit:/tmp/tmp.tXJKa7KVxR$ cp ~/data.txt .
bandit12@bandit:/tmp/tmp.tXJKa7KVxR$ ls
data.txt
bandit12@bandit:/tmp/tmp.tXJKa7KVxR$ mv data.txt hexdump_data
bandit12@bandit:/tmp/tmp.tXJKa7KVxR$ ls
hexdump_data
bandit12@bandit:/tmp/tmp.tXJKa7KVxR$ cat hexdump_data | head
00000000: 1f8b 0808 6855 1e65 0203 6461 7461 322e  ....hU.e..data2.
...
bandit12@bandit:/tmp/tmp.tXJKa7KVxR$ xxd -r hexdump_data compressed_data
bandit12@bandit:/tmp/tmp.tXJKa7KVxR$ ls
compressed_data  hexdump_data
bandit12@bandit:/tmp/tmp.tXJKa7KVxR$ mv compressed_data compressed_data.gz
bandit12@bandit:/tmp/tmp.tXJKa7KVxR$ ls
compressed_data.gz  hexdump_data
bandit12@bandit:/tmp/tmp.tXJKa7KVxR$ gzip -d compressed_data.gz
bandit12@bandit:/tmp/tmp.tXJKa7KVxR$ ls
compressed_data  hexdump_data
bandit12@bandit:/tmp/tmp.tXJKa7KVxR$ xxd compressed_data
00000000: 425a 6839 3141 5926 5359 481b 3202 0000  BZh91AY&SYH.2...
...
bandit12@bandit:/tmp/tmp.tXJKa7KVxR$ ls
compressed_data  hexdump_data
bandit12@bandit:/tmp/tmp.tXJKa7KVxR$ mv compressed_data compressed_data.bz2
bandit12@bandit:/tmp/tmp.tXJKa7KVxR$ ls
compressed_data.bz2  hexdump_data
bandit12@bandit:/tmp/tmp.tXJKa7KVxR$ bzip2 -d compressed_data.bz2
bandit12@bandit:/tmp/tmp.tXJKa7KVxR$ ls
compressed_data  hexdump_data
bandit12@bandit:/tmp/tmp.tXJKa7KVxR$ xxd compressed_data
00000000: 1f8b 0808 6855 1e65 0203 6461 7461 342e  ....hU.e..data4.
...
bandit12@bandit:/tmp/tmp.tXJKa7KVxR$ ls
compressed_data  hexdump_data
bandit12@bandit:/tmp/tmp.tXJKa7KVxR$ mv compressed_data compressed_data.gz
bandit12@bandit:/tmp/tmp.tXJKa7KVxR$ ls
compressed_data.gz  hexdump_data
bandit12@bandit:/tmp/tmp.tXJKa7KVxR$ gzip -d compressed_data.gz
bandit12@bandit:/tmp/tmp.tXJKa7KVxR$ ls
compressed_data  hexdump_data
bandit12@bandit:/tmp/tmp.tXJKa7KVxR$ cat compressed_data
data5.bin0000644000000000000000000002400014507452550011247 0ustar  rootrootdata6.bin0000644000000000000000000000033114507452550011251 0ustar  rootrootBZh91AY&SYJ!�1����&�2i6��I�P�2���@�@4��k�ʀ@��8M|�V1@��P����2[j.�v'�1��s���TTI��V��*�A�^O
bandit12@bandit:/tmp/tmp.tXJKa7KVxR$ ls
compressed_data  hexdump_data
bandit12@bandit:/tmp/tmp.tXJKa7KVxR$ mv compressed_data compressed_data.tar
bandit12@bandit:/tmp/tmp.tXJKa7KVxR$ ls
compressed_data.tar  hexdump_data
bandit12@bandit:/tmp/tmp.tXJKa7KVxR$ tar -xf compressed_data.tar
bandit12@bandit:/tmp/tmp.tXJKa7KVxR$ ls
compressed_data.tar  data5.bin  hexdump_data
bandit12@bandit:/tmp/tmp.tXJKa7KVxR$ xxd data5.bin | head
00000000: 6461 7461 362e 6269 6e00 0000 0000 0000  data6.bin.......
...
bandit12@bandit:/tmp/tmp.tXJKa7KVxR$ tar -xf data5.bin
bandit12@bandit:/tmp/tmp.tXJKa7KVxR$ ls
compressed_data.tar  data5.bin  data6.bin  hexdump_data
bandit12@bandit:/tmp/tmp.tXJKa7KVxR$ xxd data6.bin | head
00000000: 425a 6839 3141 5926 5359 0403 8894 0000  BZh91AY&SY......
...
bandit12@bandit:/tmp/tmp.tXJKa7KVxR$ bzip2 -d data6.bin
bzip2: Can't guess original name for data6.bin -- using data6.bin.out
bandit12@bandit:/tmp/tmp.tXJKa7KVxR$ ls
compressed_data.tar  data5.bin  data6.bin.out  hexdump_data
bandit12@bandit:/tmp/tmp.tXJKa7KVxR$ tar -xf data6.bin.out
bandit12@bandit:/tmp/tmp.tXJKa7KVxR$ ls
compressed_data.tar  data5.bin  data6.bin.out  data8.bin  hexdump_data
bandit12@bandit:/tmp/tmp.tXJKa7KVxR$ xxd data8.bin
00000000: 1f8b 0808 6855 1e65 0203 6461 7461 392e  ....hU.e..data9.
...
bandit12@bandit:/tmp/tmp.tXJKa7KVxR$ mv data8.bin data8.gz
bandit12@bandit:/tmp/tmp.tXJKa7KVxR$ ls
compressed_data.tar  data5.bin  data6.bin.out  data8.gz  hexdump_data
bandit12@bandit:/tmp/tmp.tXJKa7KVxR$ gzip -d data8.gz
bandit12@bandit:/tmp/tmp.tXJKa7KVxR$ ls
compressed_data.tar  data5.bin  data6.bin.out  data8  hexdump_data
bandit12@bandit:/tmp/tmp.tXJKa7KVxR$ cat data8
The password is wbWdlBxEir4CaE8LaPhauuOo6pwRmrDw
bandit12@bandit:/tmp/tmp.tXJKa7KVxR$

---
Level 13

ssh bandit13@bandit.labs.overthewire.org -p 2220
password: wbWdlBxEir4CaE8LaPhauuOo6pwRmrDw

Objective:

The password for the next level is stored in /etc/bandit_pass/bandit14 and can only be read by user bandit14. For this level, you don’t get the next password, but you get a private SSH key that can be used to log into the next level. Note: localhost is a hostname that refers to the machine you are working on.



CLI:

bandit13@bandit:~$ ssh -i sshkey.private bandit14@bandit.labs.overthewire.org -p 2220
The authenticity of host '[bandit.labs.overthewire.org]:2220 ([127.0.0.1]:2220)' can't be established.
ED25519 key fingerprint is SHA256:C2ihUBV7ihnV1wUXRb4RrEcLfXC5CXlhmAAM/urerLY.
This key is not known by any other names
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Could not create directory '/home/bandit13/.ssh' (Permission denied).
Failed to add the host to the list of known hosts (/home/bandit13/.ssh/known_hosts).
                         _                     _ _ _   
                        | |__   __ _ _ __   __| (_) |_ 
                        | '_ \ / _` | '_ \ / _` | | __|
                        | |_) | (_| | | | | (_| | | |_ 
                        |_.__/ \__,_|_| |_|\__,_|_|\__|
                                                       

                      This is an OverTheWire game server. 
            More information on http://www.overthewire.org/wargames

!!! You are trying to log into this SSH server with a password on port 2220 from localhost.
!!! Connecting from localhost is blocked to conserve resources.
!!! Please log out and log in again.


      ,----..            ,----,          .---.
     /   /   \         ,/   .`|         /. ./|
    /   .     :      ,`   .'  :     .--'.  ' ;
   .   /   ;.  \   ;    ;     /    /__./ \ : |
  .   ;   /  ` ; .'___,/    ,' .--'.  '   \' .
  ;   |  ; \ ; | |    :     | /___/ \ |    ' '
  |   :  | ; | ' ;    |.';  ; ;   \  \;      :
  .   |  ' ' ' : `----'  |  |  \   ;  `      |
  '   ;  \; /  |     '   :  ;   .   \    .\  ;
   \   \  ',  /      |   |  '    \   \   ' \ |
    ;   :    /       '   :  |     :   '  |--"
     \   \ .'        ;   |.'       \   \ ;
  www. `---` ver     '---' he       '---" ire.org


Welcome to OverTheWire!

  Enjoy your stay!

bandit14@bandit:~$ whoami
bandit14
bandit14@bandit:~$ cat etc/bandit_pass/bandit14
cat: etc/bandit_pass/bandit14: No such file or directory
bandit14@bandit:~$ cat /etc/bandit_pass/bandit14
fGrHPx402xGC7U7rXKDaxiWFTOiF0ENq
bandit14@bandit:~$ 

---
Level 14

ssh -i sshkey.private bandit14@bandit.labs.overthewire.org -p 2220
password: fGrHPx402xGC7U7rXKDaxiWFTOiF0ENq

Objective:

The password for the next level can be retrieved by submitting the password of the current level to port 30000 on localhost.

CLI:

bandit14@bandit:~$ cat /etc/bandit_pass/bandit14
fGrHPx402xGC7U7rXKDaxiWFTOiF0ENq
bandit14@bandit:~$ nc  localhost 30000
fGrHPx402xGC7U7rXKDaxiWFTOiF0ENq
Correct!
jN2kgmIXJ6fShzhT2avhotn4Zcka6tnt

---
Level 15

ssh bandit15@bandit.labs.overthewire.org -p 2220
password: jN2kgmIXJ6fShzhT2avhotn4Zcka6tnt

Objective:

The password for the next level can be retrieved by submitting the password of the current level to port 30001 on localhost using SSL encryption.

CLI:

bandit15@bandit:~$ openssl s_client -connect localhost:30001
jN2kgmIXJ6fShzhT2avhotn4Zcka6tnt
Correct!
JQttfApK4SeyHwDlI9SXGR50qclOAil1

closed
bandit15@bandit:~$

---
Level 16

ssh bandit16@bandit.labs.overthewire.org -p 2220
password: JQttfApK4SeyHwDlI9SXGR50qclOAil1

Objective:

The credentials for the next level can be retrieved by submitting the password of the current level to a port on localhost in the range 31000 to 32000. First find out which of these ports have a server listening on them. Then find out which of those speak SSL and which don’t. There is only 1 server that will give the next credentials, the others will simply send back to you whatever you send to it.

CLI:

bandit16@bandit:~$ nmap -sV localhost -p 31000-32000
Starting Nmap 7.80 ( https://nmap.org ) at 2024-03-31 18:28 UTC
Nmap scan report for localhost (127.0.0.1)
Host is up (0.00012s latency).
Not shown: 996 closed ports
PORT      STATE SERVICE     VERSION
31046/tcp open  echo
31518/tcp open  ssl/echo
31691/tcp open  echo
31790/tcp open  ssl/unknown
31960/tcp open  echo

bandit16@bandit:~$ openssl s_client -connect localhost:31790

bandit16@bandit:~$ cd /tmp
bandit16@bandit:/tmp$ touch 17key
bandit16@bandit:/tmp$ nano 17key
bandit16@bandit:/tmp$ cat 17key
bandit16@bandit:/tmp$ chmod 600 17key
bandit16@bandit:/tmp$ ls -l 17key
-rw------- 1 bandit16 bandit16 1675 Mar 31 20:59 17key
bandit16@bandit:/tmp$ ssh -i 17key bandit17@localhost -p 2220

---
Level 17

ssh bandit16@bandit.labs.overthewire.org -p 2220
password: JQttfApK4SeyHwDlI9SXGR50qclOAil1
bandit16@bandit:~$ cd /tmp
bandit16@bandit:/temp$ ssh -i 17key bandit17@localhost -p 2220

Objective:

There are 2 files in the homedirectory: passwords.old and passwords.new. The password for the next level is in passwords.new and is the only line that has been changed between passwords.old and passwords.new

NOTE: if you have solved this level and see ‘Byebye!’ when trying to log into bandit18, this is related to the next level, bandit19.

CLI:


===
Template

ssh bandit[]@bandit.labs.overthewire.org -p 2220
password: 

Objective:

CLI:

---
ssh -i sshkey.private bandit17@bandit.labs.overthewire.org -p 2220
password: 

Objective:

CLI:
===
Resources

man ssh
man ls
man cat
man file
man du
man find
man grep
man sort
man uniq
man strings
man base64
man tr
man tar
man gzip
man bzip2
man xxd
man mkdir
man cp
man mv
man telnet
man nc
man openssl
man s_client
man nmap




